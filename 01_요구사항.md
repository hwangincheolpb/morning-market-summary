# 요구사항

## 프로젝트 목표

매일 아침 지정된 시간에 금융 시황 정보를 수집하고, Gemini Gem을 활용하여 요약한 후, 문자 메시지나 카카오톡으로 자동 발송하는 시스템을 구축합니다. 엑셀을 중심으로 워크플로우를 관리하고, 스케줄링 및 발송 기능을 제공합니다.

## 문제 정의

### 현재 상황
- 매일 아침 수동으로 시황 정보 확인
- Gemini Gem에 수동으로 요청하여 시황 요약 생성
- 요약 내용을 수동으로 복사하여 문자나 카톡 발송
- 반복적인 수동 작업으로 인한 시간 소모
- 누락 가능성

### 문제점
- 매일 반복되는 수동 작업
- 시간이 지체됨
- 일관성 없는 요약 형식
- 발송 시간이 불규칙함
- 여러 수신자에게 개별 발송의 번거로움

## 요구사항

### 기능 요구사항

#### 필수 기능
- [ ] 시황 데이터 수집 (주식 지수, 환율, 금리, 원자재 가격 등)
- [ ] Gemini Gem API 연동 (또는 자동화된 요청)
- [ ] 시황 정보를 Gemini에 전달하여 요약 생성
- [ ] 요약 결과 저장 및 관리
- [ ] 엑셀을 통한 수신자 목록 관리
- [ ] 문자 메시지 자동 발송 (SMS)
- [ ] 카카오톡 메시지 자동 발송
- [ ] 스케줄링 기능 (매일 아침 지정 시간 실행)
- [ ] 발송 이력 관리

#### 선택 기능
- [ ] 여러 수신자 그룹 관리
- [ ] 개인화된 메시지 (수신자별 맞춤)
- [ ] 발송 전 미리보기 기능
- [ ] 발송 실패 시 재시도
- [ ] 요약 형식 커스터마이징
- [ ] 시황 데이터 시각화 (차트, 그래프)
- [ ] 웹훅을 통한 다른 시스템 연동
- [ ] 발송 통계 및 리포트

### 비기능 요구사항

- **성능:**
  - 시황 데이터 수집: 1분 이내
  - Gemini 요약 생성: 3분 이내
  - 전체 프로세스: 5분 이내
  - 발송 처리: 수신자당 1초 이내

- **보안:**
  - API 키 암호화 저장
  - 수신자 정보 보호
  - 발송 이력 안전하게 관리

- **사용성:**
  - 엑셀 기반으로 직관적인 관리
  - 최소한의 설정으로 동작
  - 명확한 에러 메시지
  - 발송 상태 실시간 확인

- **호환성:**
  - Windows 환경 (엑셀 실행)
  - 다양한 시황 데이터 소스 지원
  - 여러 문자 발송 서비스 지원 (알리고, 카카오톡 비즈니스 등)

## 제약사항

### 기술적 제약
- Gemini Gem API 접근 방법 (웹 인터페이스 또는 API)
- 문자 발송 서비스 API 필요
- 카카오톡 발송은 비즈니스 계정 필요
- 시황 데이터 소스의 API 제한

### 비용 제약
- 문자 발송 비용 (건당)
- 카카오톡 비즈니스 계정 비용
- Gemini API 사용 비용 (있는 경우)
- 시황 데이터 API 사용 비용

### 법적 제약
- 문자 발송 관련 법규 준수 (수신 동의 등)
- 개인정보 보호법 준수
- 스팸 방지 규정 준수

## 성공 기준

1. 매일 지정된 시간에 자동으로 실행됨
2. 시황 데이터를 정확하게 수집함
3. Gemini를 통해 의미 있는 요약이 생성됨
4. 문자 또는 카톡으로 정상 발송됨
5. 발송 이력이 정확하게 기록됨
6. 에러 발생 시 알림 및 로그 기록
7. 사용자가 추가 개입 없이 자동 동작

## 사용 시나리오

### 시나리오 1: 정상 실행
1. 매일 오전 7시에 스케줄러가 실행
2. 시황 데이터 수집 (주식, 환율, 금리 등)
3. 데이터를 Gemini Gem에 전달하여 요약 요청
4. 요약 결과를 엑셀에 저장
5. 엑셀의 수신자 목록을 읽어서
6. 각 수신자에게 문자 또는 카톡 발송
7. 발송 결과를 엑셀에 기록

### 시나리오 2: 수동 실행
1. 사용자가 엑셀에서 "지금 실행" 버튼 클릭
2. 즉시 시황 수집 및 요약 생성
3. 미리보기 화면 표시
4. 사용자가 확인 후 발송 승인
5. 발송 실행

### 시나리오 3: 에러 처리
1. 시황 데이터 수집 실패 시
   - 재시도 (최대 3회)
   - 실패 시 이전 데이터 사용 또는 알림
2. Gemini 요약 실패 시
   - 재시도
   - 실패 시 기본 템플릿 사용
3. 발송 실패 시
   - 실패한 수신자 목록 기록
   - 재시도 옵션 제공

## 시황 데이터 소스

### 지원 대상 데이터
1. **주식 지수**
   - KOSPI, KOSDAQ
   - 나스닥, 다우존스, S&P 500
   - 주요 해외 지수

2. **환율**
   - USD/KRW, EUR/KRW, JPY/KRW
   - 주요 통화 환율

3. **금리**
   - 한국 기준금리
   - 미국 금리
   - 채권 수익률

4. **원자재**
   - 금, 은 가격
   - 유가 (WTI, 브렌트)
   - 주요 원자재 가격

### 데이터 소스 옵션
- **무료 API**: Alpha Vantage, Yahoo Finance (제한적)
- **유료 API**: 한국투자증권, 키움증권 등
- **웹 스크래핑**: 금융 포털 사이트 (법적 고려 필요)
- **RSS 피드**: 뉴스 기사

## 발송 채널

### 문자 메시지 (SMS)
- **알리고 API**: 국내 주요 SMS 서비스
- **카카오 알림톡**: 카카오톡 비즈니스
- **기타 SMS 서비스**: 나이스정보통신, 쿨SMS 등

### 카카오톡
- **카카오톡 비즈니스**: 공식 비즈니스 계정 필요
- **알림톡/친구톡**: 템플릿 메시지
- **개인 메시지**: 카카오톡 API (제한적)

## Gemini Gem 활용 방법

### 옵션 1: Gemini API 직접 사용
- Google Gemini API 키 사용
- REST API 호출
- 가장 안정적이고 자동화 가능

### 옵션 2: Gemini 웹 인터페이스 자동화
- Selenium 또는 자동화 도구로 웹 접근
- 요약 요청 자동화
- 결과 추출

### 옵션 3: Gemini Gem 확장 프로그램
- Gemini Gem의 자동화 기능 활용
- 스크립트 연동
