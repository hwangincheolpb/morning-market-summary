# 구현 계획

## 구현 단계

### Phase 1: 기본 인프라 및 엑셀 구조 (2-3일)

**목표:** 엑셀 문서 구조 및 기본 설정 기능 구현

- [ ] 엑셀 통합 문서 템플릿 생성
- [ ] 시트 구조 설계 (설정, 수신자 목록, 발송 이력)
- [ ] 설정 관리 모듈 구현
- [ ] API 키 암호화 기능 구현
- [ ] 기본 UI 구성 (버튼, 메뉴)
- [ ] 로깅 시스템 구축

**예상 기간:** 2-3일

**산출물:**
- 기본 엑셀 템플릿 파일
- 설정 저장/로드 기능
- 수신자 관리 인터페이스

### Phase 2: 시황 데이터 수집 모듈 (3-4일)

**목표:** 다양한 소스에서 시황 데이터 수집

- [ ] 시황 데이터 소스 조사 및 선정
- [ ] HTTP 요청 모듈 구현 (WinHttp)
- [ ] JSON/XML 파서 구현
- [ ] 주식 지수 데이터 수집 (KOSPI, KOSDAQ, 나스닥 등)
- [ ] 환율 데이터 수집 (USD/KRW 등)
- [ ] 금리 데이터 수집
- [ ] 원자재 가격 수집 (금, 유가 등)
- [ ] 데이터 정제 및 표준화
- [ ] 에러 처리 및 재시도 로직

**예상 기간:** 3-4일

**산출물:**
- 시황 데이터 수집 모듈
- 테스트 데이터 수집 성공

### Phase 3: Gemini 요약 모듈 (3-4일)

**목표:** Gemini를 통한 시황 요약 생성

- [ ] Gemini API 키 발급 및 설정
- [ ] Gemini API 호출 모듈 구현
- [ ] 또는 Selenium을 통한 웹 자동화 구현
- [ ] 시황 데이터를 프롬프트로 변환
- [ ] 요약 요청 및 응답 처리
- [ ] 요약 결과 파싱
- [ ] 요약 형식 커스터마이징
- [ ] 에러 처리 및 재시도

**예상 기간:** 3-4일

**산출물:**
- Gemini 요약 모듈
- 테스트 요약 생성 성공

### Phase 4: SMS 발송 모듈 (2-3일)

**목표:** 알리고 또는 기타 SMS 서비스를 통한 문자 발송

- [ ] 발송 서비스 선택 및 API 키 발급
- [ ] 알리고 API 연동 구현
- [ ] 또는 기타 SMS API 연동
- [ ] 메시지 발송 함수 구현
- [ ] 발송 결과 확인
- [ ] 발송 실패 시 재시도 로직
- [ ] 발송 이력 기록

**예상 기간:** 2-3일

**산출물:**
- SMS 발송 모듈
- 테스트 발송 성공

### Phase 5: 카카오톡 발송 모듈 (2-3일)

**목표:** 카카오톡 비즈니스 API를 통한 메시지 발송

- [ ] 카카오톡 비즈니스 계정 설정
- [ ] OAuth 인증 구현
- [ ] 카카오톡 API 호출 모듈 구현
- [ ] 알림톡/친구톡 발송 구현
- [ ] 템플릿 메시지 활용
- [ ] 발송 결과 확인
- [ ] 에러 처리

**예상 기간:** 2-3일

**산출물:**
- 카카오톡 발송 모듈
- 테스트 발송 성공

### Phase 6: 워크플로우 통합 (2-3일)

**목표:** 전체 프로세스 통합 및 조율

- [ ] 메인 워크플로우 함수 구현
- [ ] 각 모듈 통합
- [ ] 에러 처리 및 로깅
- [ ] 발송 이력 자동 기록
- [ ] 통계 및 리포트 기능
- [ ] 사용자 인터페이스 개선

**예상 기간:** 2-3일

**산출물:**
- 통합 워크플로우
- 전체 프로세스 테스트 성공

### Phase 7: 스케줄링 구현 (2일)

**목표:** 자동 실행 기능 구현

- [ ] Windows Task Scheduler 연동 방법 연구
- [ ] VBS 스크립트 생성
- [ ] Task Scheduler 등록 스크립트
- [ ] 또는 Application.OnTime 구현
- [ ] 스케줄 설정 인터페이스
- [ ] 스케줄 관리 기능

**예상 기간:** 2일

**산출물:**
- 자동 실행 기능
- 스케줄 테스트 성공

### Phase 8: 테스트 및 개선 (2-3일)

**목표:** 전체 시스템 테스트 및 개선

- [ ] 단위 테스트 (각 모듈)
- [ ] 통합 테스트 (전체 워크플로우)
- [ ] 실제 데이터로 테스트
- [ ] 에러 시나리오 테스트
- [ ] 성능 최적화
- [ ] 사용자 가이드 작성
- [ ] 설정 가이드 작성

**예상 기간:** 2-3일

**산출물:**
- 테스트 완료된 시스템
- 사용자 문서

### Phase 9: 고급 기능 (선택, 3-5일)

**목표:** 추가 기능 구현

- [ ] 개인화된 메시지 (수신자별 맞춤)
- [ ] 여러 수신자 그룹 관리
- [ ] 발송 전 미리보기 기능
- [ ] 요약 형식 커스터마이징 고급 기능
- [ ] 시황 데이터 시각화 (차트)
- [ ] 발송 통계 대시보드
- [ ] 웹훅 연동

**예상 기간:** 3-5일

**산출물:**
- 고급 기능 구현
- 확장된 문서

## 우선순위

### 높은 우선순위 (MVP)
1. 기본 엑셀 문서 구조
2. 시황 데이터 수집 (최소 2-3개 소스)
3. Gemini 요약 생성
4. SMS 발송 (알리고)
5. 워크플로우 통합
6. 스케줄링

### 중간 우선순위
1. 카카오톡 발송
2. 추가 시황 데이터 소스
3. 에러 처리 개선
4. 발송 이력 관리

### 낮은 우선순위 (향후 개선)
1. 개인화된 메시지
2. 시각화 기능
3. 통계 대시보드
4. 웹훅 연동

## 의존성

### Phase 간 의존성
- Phase 2-5는 Phase 1 완료 후 병렬 진행 가능
- Phase 6는 Phase 2-5 중 최소 2개 완료 후 시작
- Phase 7는 Phase 6 완료 후 시작
- Phase 8는 Phase 7 완료 후 시작
- Phase 9는 Phase 8 완료 후 시작

### 외부 의존성
- Microsoft Excel 2016 이상
- Windows 환경
- 인터넷 연결
- Gemini API 키 또는 접근 권한
- 발송 서비스 API 키 (알리고, 카카오톡)
- 시황 데이터 API 접근 권한

## 리스크 및 대응 방안

| 리스크 | 영향도 | 확률 | 대응 방안 |
|--------|--------|------|-----------|
| Gemini API 접근 제한 | 높음 | 중간 | 웹 자동화 대안 준비, 또는 다른 AI 모델 활용 |
| 시황 데이터 API 제한 | 높음 | 높음 | 여러 데이터 소스 준비, 무료 API 우선 활용, 웹 스크래핑 대안 |
| 발송 서비스 API 비용 | 중간 | 높음 | 무료 할당량 활용, 비용 모니터링, 효율적인 발송 |
| 카카오톡 비즈니스 계정 필요 | 중간 | 높음 | SMS만 먼저 구현, 카카오톡은 선택 기능으로 |
| 스케줄링 복잡성 | 중간 | 중간 | Windows Task Scheduler 활용, 간단한 VBS 스크립트 |
| VBA 성능 제한 | 낮음 | 중간 | 비동기 처리 고려, 또는 Python 스크립트 연동 |
| 법적 제약 (스팸 방지) | 높음 | 낮음 | 수신 동의 확인, 발송 규정 준수, 법무 검토 |

## 마일스톤

### 마일스톤 1: 기본 구조 완성 (1주)
- [ ] Phase 1-2 완료
- **목표:** 엑셀 구조 및 시황 데이터 수집 동작

### 마일스톤 2: 핵심 기능 완성 (2주)
- [ ] Phase 3-4 완료
- **목표:** Gemini 요약 및 SMS 발송 동작

### 마일스톤 3: 통합 완성 (3주)
- [ ] Phase 5-7 완료
- **목표:** 전체 워크플로우 및 자동 실행 동작

### 마일스톤 4: MVP 완성 (4주)
- [ ] Phase 8 완료
- **목표:** 사용 가능한 버전 릴리스

### 마일스톤 5: 고급 기능 (선택, 5-6주)
- [ ] Phase 9 완료
- **목표:** 확장 기능 포함 완성 버전

## 테스트 계획

### 단위 테스트
- 각 모듈 개별 테스트
- 시황 데이터 수집 테스트
- Gemini API 호출 테스트
- 발송 모듈 테스트

### 통합 테스트
- 전체 워크플로우 테스트
- 실제 데이터로 테스트
- 에러 시나리오 테스트
- 스케줄링 테스트

### 사용자 테스트
- 실제 시황 데이터 수집 테스트
- 실제 발송 테스트 (테스트 번호)
- 장기 실행 테스트 (1주일)
- 다양한 시나리오 테스트

## 배포 계획

### 배포 방법
- 엑셀 템플릿 파일 (.xlsm) 제공
- 설정 가이드 문서 포함
- API 키 발급 가이드 제공
- 샘플 설정 파일 제공

### 버전 관리
- Semantic Versioning (v1.0.0)
- 초기 버전: v0.1.0 (알파)
- MVP 완성: v1.0.0

### 업데이트 방법
- 새 버전의 엑셀 파일 제공
- 설정 마이그레이션 가이드 제공
